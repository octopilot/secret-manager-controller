---
apiVersion: secret-management.microscaler.io/v1beta1
kind: SecretManagerConfig
metadata:
  name: test-sops-config-azure
  namespace: tilt
spec:
  # Source reference - points to the tilt GitRepository in the same namespace
  sourceRef:
    kind: GitRepository
    name: gitrepository-tilt
    namespace: tilt
  
  # Secrets configuration
  secrets:
    # Environment name - must match the directory name under profiles/
    environment: tilt
    
    # Optional: Base path within the repository
    # Leave empty for single-service structure
    # Set to "microservices" for monolith structure
    basePath: ""
    
    # Optional: Default service name (used if not found in directory structure)
    # defaultServiceName: "test-service"
    
    # Secret prefix for cloud provider
    prefix: "test-service"
    
    # Optional: Suffix for secret names
    # suffix: "dev"
  
  # Config store routing (optional)
  # When enabled, application.properties routes to config stores instead of secrets
  configs:
    enabled: false
    # For AWS: routes to Parameter Store
    # For GCP: routes to Secret Manager (interim solution)
    # For Azure: routes to App Configuration
  
  # Cloud provider configuration
  provider:
    azure:
      vaultName: test-vault
      # Optional: Authentication configuration
      # auth:
      #   authType: ManagedIdentity
      #   clientId: your-client-id
  
  # Reconcile interval - how often to reconcile secrets between Git and cloud providers
  # Dev environment: 1 minute (default)
  reconcileInterval: "1m"
  
  # GitRepository pull update interval
  # How often to check for updates from the GitRepository source
  # Dev environment: 1 minute (default)
  gitRepositoryPullInterval: "1m"

