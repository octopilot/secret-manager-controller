---
apiVersion: secret-management.octopilot.io/v1beta1
kind: SecretManagerConfig
metadata:
  name: test-sops-config-stage-aws
  namespace: stage
spec:
  # Source reference - points to the stage GitRepository in the same namespace
  sourceRef:
    kind: GitRepository
    name: gitrepository-stage
    namespace: stage
  
  # Secrets configuration
  secrets:
    # Environment name - must match the directory name under profiles/
    environment: stage
    
    # Optional: Base path within the repository
    # Leave empty for single-service structure
    # Set to "microservices" for monolith structure
    basePath: ""
    
    # Optional: Default service name (used if not found in directory structure)
    # defaultServiceName: "test-service"
    
    # Secret prefix for cloud provider
    prefix: "test-service-stage"
    
    # Optional: Suffix for secret names
    # suffix: "stage"
  
  # Config store routing (optional)
  # When enabled, application.properties routes to config stores instead of secrets
  configs:
    enabled: false
    # For AWS: routes to Parameter Store
    # For GCP: routes to Secret Manager (interim solution)
    # For Azure: routes to App Configuration
  
  # Cloud provider configuration
  provider:
    aws:
      region: us-east-1
      # Optional: Authentication configuration
      # auth:
      #   authType: IAMRole
      #   roleArn: arn:aws:iam::123456789012:role/secret-manager-role
  
  # Reconcile interval - how often to reconcile secrets between Git and cloud providers
  # Stage environment: 3 minutes
  reconcileInterval: "3m"
  
  # GitRepository pull update interval
  # How often to check for updates from the GitRepository source
  # Stage environment: 3 minutes
  gitRepositoryPullInterval: "3m"

