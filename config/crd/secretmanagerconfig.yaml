# This file is auto-generated by crdgen
# DO NOT EDIT THIS FILE MANUALLY
# If there are malformed YAML issues, fix them in the Rust code (src/controller/crdgen.rs or src/main.rs)
# This file will be overwritten on every code update
#
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: secretmanagerconfigs.secret-management.microscaler.io
spec:
  group: secret-management.microscaler.io
  names:
    categories: []
    kind: SecretManagerConfig
    plural: secretmanagerconfigs
    shortNames:
    - smc
    singular: secretmanagerconfig
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.phase
      name: Phase
      type: string
    - jsonPath: .status.description
      name: Description
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    name: v1
    schema:
      openAPIV3Schema:
        description: Auto-generated derived type for SecretManagerConfigSpec via `CustomResource`
        properties:
          spec:
            properties:
              configs:
                description: |-
                  Config store configuration for routing application.properties to config stores
                  When enabled, properties are stored individually in config stores instead of as a JSON blob in secret stores
                nullable: true
                properties:
                  appConfigEndpoint:
                    description: |-
                      Azure-specific: App Configuration endpoint
                      Only applies when provider.type == azure
                      Optional: defaults to auto-detection from vault region if not specified
                      Example: https://my-app-config.azconfig.io
                    nullable: true
                    type: string
                  enabled:
                    default: false
                    description: |-
                      Enable config store sync (default: false for backward compatibility)
                      When true, application.properties files are routed to config stores
                      When false, properties are stored as a JSON blob in secret stores (current behavior)
                    type: boolean
                  parameterPath:
                    description: |-
                      AWS-specific: Parameter path prefix
                      Only applies when provider.type == aws
                      Optional: defaults to /{prefix}/{environment} if not specified
                      Example: /my-service/dev
                    nullable: true
                    type: string
                  store:
                    description: |-
                      GCP-specific: Store type (default: SecretManager)
                      Only applies when provider.type == gcp
                      - SecretManager: Store configs as individual secrets in Secret Manager (interim solution)
                      - ParameterManager: Store configs in Parameter Manager (future, after ESO contribution)
                    enum:
                    - secretManager
                    - ParameterManager
                    nullable: true
                    type: string
                type: object
              diffDiscovery:
                default: true
                description: |-
                  Enable diff discovery
                  When enabled, detects if secrets have been tampered with in Secret Manager or Parameter Manager
                  and logs warnings when differences are found between Git (source of truth) and cloud provider
                  Default: true (enabled)
                type: boolean
              gitRepositoryPullInterval:
                default: 5m
                description: |-
                  GitRepository pull update interval
                  How often to check for updates from the GitRepository source
                  Format: Kubernetes duration string (e.g., "1m", "5m", "1h")
                  Minimum: 1m (60 seconds) - shorter intervals may hit API rate limits
                  Default: "5m" (5 minutes)
                  Recommended: 5m or greater to avoid rate limiting
                type: string
              provider:
                description: Cloud provider configuration. Supports GCP, AWS, and Azure. Must have a 'type' field set to 'gcp', 'aws', or 'azure'.
                title: AnyValue
                x-kubernetes-preserve-unknown-fields: true
              reconcileInterval:
                default: 1m
                description: |-
                  Reconcile interval
                  How often to reconcile secrets between Git and cloud providers (Secret Manager or Parameter Manager)
                  Format: Kubernetes duration string (e.g., "1m", "30s", "5m")
                  Default: "1m" (1 minute)
                type: string
              secrets:
                description: Secrets sync configuration
                properties:
                  basePath:
                    nullable: true
                    type: string
                  environment:
                    type: string
                  kustomizePath:
                    nullable: true
                    type: string
                  prefix:
                    nullable: true
                    type: string
                  suffix:
                    nullable: true
                    type: string
                required:
                - environment
                type: object
              sourceRef:
                properties:
                  kind:
                    default: GitRepository
                    type: string
                  name:
                    type: string
                  namespace:
                    type: string
                required:
                - name
                - namespace
                type: object
              suspend:
                default: false
                description: |-
                  Suspend reconciliation
                  When true, the controller will skip reconciliation for this resource
                  Useful for troubleshooting or during intricate CI/CD transitions where secrets need to be carefully managed
                  Manual reconciliation via msmctl will also be blocked when suspended
                  Default: false (reconciliation enabled)
                type: boolean
              suspendGitPulls:
                default: false
                description: |-
                  Suspend GitRepository pulls
                  When true, suspends Git pulls from the referenced GitRepository but continues reconciliation with the last pulled commit
                  This is useful when you want to freeze the Git state but keep syncing secrets from the current commit
                  The controller will automatically patch the GitRepository resource to set suspend: true/false
                  Default: false (Git pulls enabled)
                type: boolean
              triggerUpdate:
                default: true
                description: |-
                  Enable update triggers
                  When enabled, automatically updates cloud provider secrets if Git values have changed since last pull
                  This ensures Git remains the source of truth
                  Default: true (enabled)
                type: boolean
            required:
            - provider
            - secrets
            - sourceRef
            type: object
          status:
            nullable: true
            properties:
              conditions:
                default: []
                items:
                  properties:
                    lastTransitionTime:
                      nullable: true
                      type: string
                    message:
                      nullable: true
                      type: string
                    reason:
                      nullable: true
                      type: string
                    status:
                      type: string
                    type:
                      type: string
                  required:
                  - status
                  - type
                  type: object
                type: array
              description:
                description: |-
                  Human-readable description of current state
                  Examples: "Clone failed, repo unavailable", "Reconciling secrets to Secret Manager", "Reconciling properties to Parameter Manager"
                nullable: true
                type: string
              lastReconcileTime:
                nullable: true
                type: string
              nextReconcileTime:
                description: |-
                  Next scheduled reconciliation time (RFC3339)
                  Used to persist periodic reconciliation schedule across watch restarts
                nullable: true
                type: string
              observedGeneration:
                format: int64
                nullable: true
                type: integer
              phase:
                description: |-
                  Current phase of reconciliation
                  Values: Pending, Started, Cloning, Updating, Failed, Ready
                nullable: true
                type: string
              secretsSynced:
                format: int32
                nullable: true
                type: integer
            type: object
        required:
        - spec
        title: SecretManagerConfig
        type: object
    served: true
    storage: true
    subresources:
      status: {}
