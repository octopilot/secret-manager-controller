apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: secret-manager-controller-sops
  namespace: microscaler-system
rules:
# Allow list and watch on all secrets in controller namespace for watching
# The controller filters to only watch sops-private-key, sops-gpg-key, and gpg-key
- apiGroups:
  - ""
  resources:
  - secrets
  verbs:
  - list
  - watch
# Allow get on specific secret names only
- apiGroups:
  - ""
  resources:
  - secrets
  verbs:
  - get
  resourceNames:
  - sops-private-key
  - sops-gpg-key
  - gpg-key



